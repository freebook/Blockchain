<?xml version="1.0" encoding="UTF-8"?>

	&chapter.ethereum.devel.node.xml;
	&chapter.ethereum.devel.java.xml;

<chapter id="web3.py">
	<title>web3.py - A python interface for interacting with the Ethereum
		blockchain and ecosystem.
	</title>
	<para>
		文档地址
		<ulink url="http://web3py.readthedocs.io/">http://web3py.readthedocs.io/</ulink>
	</para>
	<section id="web3.py.install">
		<title>安装 web3.py 开发环境</title>
		<screen>
		<![CDATA[
neo@MacBook-Pro ~/ethereum/web3.py % pip3 install web3
		]]>
		</screen>
	</section>
	<section id="">
		<title>连接到以太坊节点</title>
		<section id="">
			<title>HTTP</title>
			<programlisting>
			<![CDATA[
>>> from web3 import Web3
>>> web3 = Web3(Web3.HTTPProvider("http://127.0.0.1:8545")
			]]>
			</programlisting>
		</section>
		<section id="">
			<title>IPC</title>
			<programlisting>
			<![CDATA[
>>> from web3 import Web3
>>> web3 = Web3(Web3.IPCProvider("~/Library/Ethereum/geth.ipc"))	
			]]>
			</programlisting>
		</section>
		<section id="">
			<title>Websocket</title>
			<programlisting>
			<![CDATA[
>>> from web3 import Web3
>>> web3 = Web3(Web3.WebsocketProvider("ws://127.0.0.1:8546")			
			]]>
			</programlisting>
		</section>
		
	</section>
	<section id="web3.py.sendTransaction">
		<title>交易</title>
		<section id="">
			<title>发送 ETH</title>
			<programlisting>
			<![CDATA[
from web3 import Web3
web3 = Web3(Web3.IPCProvider("~/Library/Ethereum/geth.ipc"))	

fromAddress = '0xf56b81a2bcb964D2806071e9Be4289A5559BB0fA'
toAddress = '0x997e5CA600E19447D0B82aFBf9c7F00De2B39B16'
value = 0.0001

web3.personal.unlockAccount(fromAddress, '12345678')
web3.eth.sendTransaction({'to': toAddress, 'from': fromAddress, 'value': value})
			]]>
			</programlisting>
		</section>
		<section id="">
			<title>签名发送 ETH</title>
			<programlisting>
			<![CDATA[
from web3 import Web3
web3 = Web3(Web3.IPCProvider("https://ropsten.infura.io/CsS9shwaAab0z7B4LP2d"))	

privateKey = '8D16063C3F665A6FB37195D18968E63CC04CEE4BFB1B98C184121D4C31D9875E'
fromAddress = "0xb3cedc76e75fcd278c988b22963c2f35c99c10b7"
toAddress = '0x997e5CA600E19447D0B82aFBf9c7F00De2B39B16'
amount = 0.0001

signed_txn = web3.eth.account.signTransaction(dict(
    nonce=web3.eth.getTransactionCount(fromAddress),
    gasPrice=web3.eth.gasPrice,
    gas=21000,
    to=toAddress,
    value=amount,
    data=b'',
  ),
  private_key,
)
web3.eth.sendRawTransaction(signed_txn.rawTransaction)
			]]>
			</programlisting>
		</section>
	</section>
</chapter>
<chapter>
	<title>Ethereum iOS</title>
	<para>
		<ulink url="https://github.com/MercuryProtocol/web3.swift" />
	</para>
	<para>https://medium.com/mercuryprotocol/introducing-web3-swift-for-ethereum-ios-development-1e02212b662b</para>
</chapter>
<chapter id="index"><?dbhtml dir="api" ?>
	<title>Ethereum Developer APIs</title>
	<section>
		<title>API Keys</title>
		<para>https://etherscan.io/register</para>
		<graphic format="png" fileref="../../images/ethereum/etherscan/api/newaccount.png" width="" srccredit="netkiller" />
		<para>前往邮箱查看以太坊发出的确认邮件，并点击里面链接地址。</para>
		<graphic format="png" fileref="../../images/ethereum/etherscan/api/email.png" width="" srccredit="netkiller" />
		<para>登陆</para>
		<graphic format="png" fileref="../../images/ethereum/etherscan/api/login.png" width="" srccredit="netkiller" />
		<para>创建 API Key</para>
		<graphic format="png" fileref="../../images/ethereum/etherscan/api/api-keys-create.png" width="" srccredit="netkiller" />
		<graphic format="png" fileref="../../images/ethereum/etherscan/api/api-keys-token.png" width="" srccredit="netkiller" />
		<para>创建完成</para>
		<graphic format="png" fileref="../../images/ethereum/etherscan/api/api-keys-successfully.png" width="" srccredit="netkiller" />
	</section>
	<section>
		<title>账号</title>
		<para>获得账号的余额</para>
		<screen>
		<![CDATA[
https://api.etherscan.io/api?module=account&action=balance&address=0xddbd2b932c763ba5b1b7ae3b362eac3e8d40121a&tag=latest&apikey=JFZWPE88I3TZFZWXKVHJ32INUIYQRRINJ9
		]]>
		</screen>
	</section>

	<section id="ethereum.jsonrpc">
		<title>jsonrpc 原生交口调用</title>
		<screen>
		<![CDATA[
neo@MacBook-Pro ~ % curl -XPOST -H "Accept: application/json" -H "Content-Type: application/json" -d '{"jsonrpc":"2.0","method":"eth_getBalance","params":["0x5c18a33df2cc41a1beddc91133b8422e89f041b7", "latest"],"id":1}' http://localhost:8545 
{"jsonrpc":"2.0","id":1,"result":"0x153e5f3aeb667075800"}		
		]]>
		</screen>
		<screen>
		<![CDATA[
curl -X POST --data '{"jsonrpc":"2.0","method":"eth_accounts","params":[],"id":1}'		

curl -X POST --data '{"jsonrpc":"2.0","method":"eth_getBalance","params":["0x407d73d8a49eeb85d32cf465507dd71d507100c1", "latest"],"id":1}'
		]]>
		</screen>
	</section>

</chapter>